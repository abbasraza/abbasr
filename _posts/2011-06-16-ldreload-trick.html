---
layout: post
title: LD_PRELOAD Trick
date: '2011-06-16T12:58:00.003+05:00'
author: Abbas Raza
tags:
- library
- LD_PRELOAD
modified_time: '2011-06-16T13:00:55.912+05:00'
blogger_id: tag:blogger.com,1999:blog-3367966882409306161.post-4115045110020134891
blogger_orig_url: https://abbas-raza.blogspot.com/2011/06/ldreload-trick.html
---

<div dir="ltr" style="text-align: left;" trbidi="on"><pre class="lang-c prettyprint" style="font-family: &quot;Courier New&quot;,Courier,monospace;"><span style="font-size: small;">You can override symbols in the stock libraries by creating a library <br />with the same symbols and specifying the library in LD_PRELOAD.<code><span class="pln"> </span></code></span></pre><span style="font-size: small;"><span style="font-family: &quot;Courier New&quot;,Courier,monospace;"> </span></span><br /><div style="font-family: &quot;Courier New&quot;,Courier,monospace;"><span style="font-size: small;"><br /></span></div><div style="font-family: &quot;Courier New&quot;,Courier,monospace;"><span style="font-size: small;">For example you can write a library which implement malloc and free. And  by loading these with LD_PRELOAD your malloc and free will be executed  rather than the standard ones. </span></div><div style="font-family: &quot;Courier New&quot;,Courier,monospace;"><span style="font-size: small;"><br /></span></div><div style="font-family: &quot;Courier New&quot;,Courier,monospace;"><span style="font-size: small;">So to run "ls" with your special malloc() implementation, do this:</span></div><span style="font-size: small;"><span style="font-family: &quot;Courier New&quot;,Courier,monospace;">  </span></span><br /><pre class="lang-c prettyprint" style="font-family: &quot;Courier New&quot;,Courier,monospace;"><span style="font-size: small;"><code><span class="pln"><br /><span style="font-family: &quot;Courier New&quot;,Courier,monospace;">$ LD_PRELOAD</span></span><span class="pun" style="font-family: &quot;Courier New&quot;,Courier,monospace;">=/</span><span class="pln" style="font-family: &quot;Courier New&quot;,Courier,monospace;">path</span><span class="pun" style="font-family: &quot;Courier New&quot;,Courier,monospace;">/</span><span class="pln" style="font-family: &quot;Courier New&quot;,Courier,monospace;">to</span><span class="pun" style="font-family: &quot;Courier New&quot;,Courier,monospace;">/</span><span class="pln" style="font-family: &quot;Courier New&quot;,Courier,monospace;">my</span><span class="pun" style="font-family: &quot;Courier New&quot;,Courier,monospace;">/</span><span class="pln" style="font-family: &quot;Courier New&quot;,Courier,monospace;">malloc</span><span class="pun" style="font-family: &quot;Courier New&quot;,Courier,monospace;">.</span><span class="pln" style="font-family: &quot;Courier New&quot;,Courier,monospace;">so </span><span class="pun" style="font-family: &quot;Courier New&quot;,Courier,monospace;">/</span><span class="pln" style="font-family: &quot;Courier New&quot;,Courier,monospace;">bin</span><span class="pun" style="font-family: &quot;Courier New&quot;,Courier,monospace;">/</span><span class="pln" style="font-family: &quot;Courier New&quot;,Courier,monospace;">ls</span></code></span></pre><pre class="lang-c prettyprint" style="font-family: &quot;Courier New&quot;,Courier,monospace;"><span style="font-size: small;"><code><span class="pln">&nbsp;</span></code></span></pre><pre class="lang-c prettyprint" style="font-family: &quot;Courier New&quot;,Courier,monospace;"><span style="font-size: small;"><code><span class="pln">OR</span></code></span></pre><pre class="lang-c prettyprint" style="font-family: &quot;Courier New&quot;,Courier,monospace;"><span style="font-size: small;"><code><span class="pln"> </span></code></span></pre><pre class="lang-c prettyprint" style="font-family: &quot;Courier New&quot;,Courier,monospace;"><span style="font-size: small;"><code><span class="pln">$ </span></code><code><span class="pln">LD_PRELOAD</span><span class="pun">=/</span><span class="pln">path</span><span class="pun">/</span><span class="pln">to</span><span class="pun">/</span><span class="pln">my</span><span class="pun">/</span><span class="pln">malloc</span><span class="pun">.</span><span class="pln">so</span></code><br /><code><span class="pln">$ </span></code><code><span class="pln">export LD_PRELOAD</span></code></span></pre><pre class="lang-c prettyprint" style="font-family: &quot;Courier New&quot;,Courier,monospace;"><span style="font-size: small;"><code><span class="pln">$ /bin/ls</span><span class="pun"></span><span class="pln"></span><span class="pun"></span><span class="pln"></span><span class="pun"></span><span class="pln"></span><span class="pun"></span><span class="pln"></span><span class="pun"></span><span class="pln"></span></code><br /></span></pre><pre class="lang-c prettyprint" style="font-family: &quot;Courier New&quot;,Courier,monospace;"><span style="font-size: small;"><code><span class="pln">&nbsp;</span></code></span></pre><pre class="lang-c prettyprint" style="font-family: &quot;Courier New&quot;,Courier,monospace;"><span style="font-size: small;"><code><span class="pln"><br /></span></code></span></pre></div>
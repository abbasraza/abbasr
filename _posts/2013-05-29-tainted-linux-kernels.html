---
layout: post
title: 'Tainted Linux Kernels '
date: '2013-05-29T03:42:00.002+05:00'
author: Abbas Raza
tags: 
modified_time: '2013-05-29T03:42:54.001+05:00'
blogger_id: tag:blogger.com,1999:blog-3367966882409306161.post-8951625721900172167
blogger_orig_url: https://abbas-raza.blogspot.com/2013/05/tainted-linux-kernels.html
---

<div dir="ltr" style="text-align: left;" trbidi="on"><span class="contentText"><span class="postcolor"></span></span><br /><div class="style29" style="page-break-after: avoid;"><span class="contentText">As has already been shown, the kernel is       the heart of the operating system, and therefore it is       important that the state of the kernel is known and       controlled. Since it is possible to modify the kernel with       LKM (loadable kernel modules)       then it is also possible to place the kernel in an unknown       or unreliable status. When this happens, the kernel is said       to be ‘tainted’.</span></div><div class="style25"><span class="contentText"><o:p></o:p></span></div><span class="contentText">     <div class="style25"><br /></div><div class="style25">The taint status of the kernel is       maintained by a set of flags and when no flags are set, the       kernel is reliable, or untainted. When the kernel becomes       tainted, a kernel error message is raised and a single       character flag is set to indicate what caused the tainted       status. Some, but not all of the flags, are listed below.<o:p></o:p></div><div class="style30">     <span style="font-family: Wingdings; font-size: 6.0pt; mso-bidi-font-family: Wingdings; mso-fareast-font-family: Wingdings;">     n<span style="font: 7.0pt &quot;Times New Roman&quot;;">&nbsp;      </span></span>P:&nbsp;      This means that the kernel has a Proprietary license       loaded. It could be a module that is not under GNU General       Public License (GPL) or a compatible license.<o:p></o:p></div><div class="style30">     <span style="font-family: Wingdings; font-size: 6.0pt; mso-bidi-font-family: Wingdings; mso-fareast-font-family: Wingdings;">     n<span style="font: 7.0pt &quot;Times New Roman&quot;;">&nbsp;      </span></span>G:&nbsp;      All modules loaded were licensed under the GPL or a       license compatible with the GPL, but something else has       tainted the kernel. This will be indicated in a different       flag.<o:p></o:p></div><div class="style30">     <span style="font-family: Wingdings; font-size: 6.0pt; mso-bidi-font-family: Wingdings; mso-fareast-font-family: Wingdings;">     n<span style="font: 7.0pt &quot;Times New Roman&quot;;">&nbsp;      </span></span>F:&nbsp;      This is a module that was loaded using the Force       option <i>-f</i> of <i>insmod</i> or <i>modprobe</i>, so       versioning information cannot be checked.<o:p></o:p></div><div class="style30">     <span style="font-family: Wingdings; font-size: 6.0pt; mso-bidi-font-family: Wingdings; mso-fareast-font-family: Wingdings;">     n<span style="font: 7.0pt &quot;Times New Roman&quot;;">&nbsp;      </span></span>M: This is a Machine Check       Exception (MCE) triggered by hardware to indicate a hardware       related problem.<o:p></o:p></div><div class="style25">Once the tainted status has been set, the       status is permanent. Even if whatever caused the taint has       been corrected, the flag remains set until the kernel is       restarted. The DBA can control if a kernel is tainted or not       by checking the <span class="style31">     /proc/sys/kernel/tainted</span>       virtual file.<o:p></o:p></div><div class="style25"><br /></div><div style="background: #E6E6E6; border: dotted windowtext 1.0pt; margin-left: .2in; margin-right: 0in; mso-border-alt: dotted windowtext .5pt; mso-element: para-border-div; padding: 1.0pt 4.0pt 1.0pt 4.0pt;">      <div class="style32">$ cat /proc/sys/kernel/tainted<o:p></o:p></div></div><div class="style33"><br />0<o:p></o:p></div><div class="style25"><br /></div><div class="style25">If the output is 0, the kernel is not       tainted, and when the output is other than zero, then kernel       is tainted. Alternatively, use the following command to       perform the same check: <o:p></o:p></div><div class="style25"><br /></div><div style="background: #E6E6E6; border: dotted windowtext 1.0pt; margin-left: .2in; margin-right: 0in; mso-border-alt: dotted windowtext .5pt; mso-element: para-border-div; padding: 1.0pt 4.0pt 1.0pt 4.0pt;">      <div class="style32">&nbsp;/sbin/lsmod <o:p></o:p>      </div></div><div class="style25"><br /></div><div class="style25">As result of the <span class="style31">     lsmod</span>&nbsp;command,       a header line appears that should include the text ‘Not       tainted', as in the following output:<o:p></o:p></div><div class="style25"><br /></div><div style="background: #E6E6E6; border: dotted windowtext 1.0pt; margin-left: .2in; margin-right: 0in; mso-border-alt: dotted windowtext .5pt; mso-element: para-border-div; padding: 1.0pt 4.0pt 1.0pt 4.0pt;">      <div class="style32">oracle2@linux-mlpb:~&gt; lsmod<o:p></o:p></div><div class="style32">Module Size Used by Not tainted<o:p></o:p></div><div class="style32">vmsync&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;       10016&nbsp;       0 <o:p></o:p></div><div class="style32">vmmemctl&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;       14104&nbsp;       0 <o:p></o:p></div><div class="style32"><br /></div><div class="style32">(…)<o:p></o:p></div></div><div class="style25"><br /></div><div class="style25">In the file <span class="style31">     /proc/modules</span>, all the information can be found about       the modules loaded in the kernel. The content of that file       varies depending on the Linux distribution used and the       configuration.&nbsp;       The content of the file <span class="style31">/proc/modules</span>       can be viewed like a text file with the      <span class="style31">cat</span> or <span class="style31">     less</span> command. The number of lines in the output       hereunder is reduced for length reasons.<o:p></o:p></div><div class="style25"><br /></div><div style="background: #E6E6E6; border: dotted windowtext 1.0pt; margin-left: .2in; margin-right: 0in; mso-border-alt: dotted windowtext .5pt; mso-element: para-border-div; padding: 1.0pt 4.0pt 1.0pt 4.0pt;">      <div class="style32">oracle@linux-mlpb:~&gt; cat        /proc/modules<o:p></o:p></div><div class="style32">vmsync 10016 0 - Live 0xf8c48000<o:p></o:p></div><div class="style32">vmmemctl 14104 0 - Live 0xf8c5f000<o:p></o:p></div><div class="style32">vmblock 20516 3 - Live 0xf8c58000<o:p></o:p></div><div class="style32">binfmt_misc 15752 1 - Live 0xf8c53000<o:p></o:p></div><div class="style32">      <span lang="DA">(…)<o:p></o:p></span></div><div class="style32">      <span lang="DA">      scsi_transport_spi 29184 1 mptspi, Live 0xf883d000<o:p></o:p></span></div><div class="style32">      <span lang="DA">scsi_mod        156020 7        sr_mod,sg,sd_mod,libata,mptspi,mptscsih,scsi_transport_spi,        Live 0xf8d64000<o:p></o:p></span></div><div class="style32">thermal 27164 0 - Live 0xf8826000<o:p></o:p></div><div class="style32">processor 53552 1 thermal, Live        0xf882e000<o:p></o:p></div></div><div class="style25"><br /></div><div class="style25">With the root user, more information can       be obtained about the modules loaded by using the command      <span class="style31">modinfo</span> and the name of the       module that was found in <span class="style31">/proc/modules</span>.       This example shows the information about the processor       modules. <o:p></o:p></div><div class="style25"><br /></div><div style="background: #E6E6E6; border: dotted windowtext 1.0pt; margin-left: .2in; margin-right: 0in; mso-border-alt: dotted windowtext .5pt; mso-element: para-border-div; padding: 1.0pt 4.0pt 1.0pt 4.0pt;">      <div class="style32">linux-mlpb:~ # modinfo processor <o:p></o:p>      </div><div class="style32">filename:&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;       /lib/modules/2.6.25.5-1.1-default/kernel/drivers/acpi/processor.ko<o:p></o:p></div><div class="style32">alias:&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;       processor<o:p></o:p></div><div class="style32">license:&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;       GPL<o:p></o:p></div><div class="style32">description:&nbsp;&nbsp;&nbsp;       ACPI Processor Driver<o:p></o:p></div><div class="style32">author:&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;       Paul Diefenbaugh<o:p></o:p></div><div class="style32">srcversion:&nbsp;&nbsp;&nbsp;&nbsp;       F22498BC60F67547B41B9F1<o:p></o:p></div><div class="style32">alias:&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;       acpi*:ACPI0007:*<o:p></o:p></div><div class="style32">depends:&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;       <o:p></o:p></div><div class="style32">supported:&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;       yes<o:p></o:p></div><div class="style32">vermagic:&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;       2.6.25.5-1.1-default <st1:stockticker w:st="on">SMP</st1:stockticker> mod_unload 586 <o:p></o:p></div><div class="style32">parm:&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;       ignore_ppc:If the frequency of your machine gets        wronglylimited by BIOS, this should help (uint)<o:p></o:p></div><div class="style32">parm:&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;       max_cstate:uint<o:p></o:p></div><div class="style32">parm:&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;       nocst:uint<o:p></o:p></div><div class="style32">parm:&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;       latency_factor:uint<o:p></o:p></div></div><div class="style25"><br /></div><div class="style25">It is possible to get specific       information by using specific shortcut switches from the      <span class="style31">modinfo</span>command on the license with      <span class="style31">modinfo -l</span> and about the       parameter with <span class="style31">modinfo –p</span>.       Other switches that are <span class="style31">-a</span>     <span class="style31">-d –n</span> are informing the user       respectively about the author, description and the file       name. <o:p></o:p></div><div class="style25"><br /></div><div style="background: #E6E6E6; border: dotted windowtext 1.0pt; margin-left: .2in; margin-right: 0in; mso-border-alt: dotted windowtext .5pt; mso-element: para-border-div; padding: 1.0pt 4.0pt 1.0pt 4.0pt;">      <div class="style32">linux-mlpb:~ # modinfo -l&nbsp;       processor <o:p></o:p></div><div class="style32">GPL<o:p></o:p></div><div class="style32">linux-mlpb:~ # modinfo -p&nbsp;       processor <o:p></o:p></div><div class="style32">ignore_ppc:If the frequency of your        machine gets wronglylimited by BIOS, this should help<o:p></o:p></div></div><div class="style25"><br /></div><div class="style25">It is possible to remove modules with the       command <span class="style31">rmmod</span>. This command must be used as the user       root. An autoclean function can be invoked to delete unused       modules with the command <span class="style31">rmmod -a</span>.&nbsp; &nbsp; &nbsp; &nbsp;<o:p></o:p></div></span></div>